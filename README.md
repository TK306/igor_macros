# igor_macros
以下のマクロは全て独立に動きます。

## Any_CIW
Any_CIW_manual.pdfを参照

## make_vol_scale
2次元イメージwaveのx, yスケールを揃えて3次元ボリュームwaveを作成するマクロ

### 使い方
1. データブラウザでボリュームにしたい2D wavesを選択し、Macro > Make_vol_scaleを選択。
2. 出現したプロンプトから出力wave名、出力waveのx, y点数を設定し、実行する。

### 仕様
* 入力waveのX, Yスケールはもちろん、データ点数がバラバラでも動きます。
* 出力waveのX, Y方向のサイズは任意です。大きくしても補完はされません。
* データブラウザで表示されている順番に並びます。並び替えたい場合は、自分で名前を変えてソートしてください。

## rot_wave
2次元イメージまたは3次元ボリュームを回転するマクロ

### 使い方
1. 回転したい2Dまたは3D waveをデータブラウザで一つ選択し、Macro > Call_Rot_Wave_panelを選択。
2. 出現したパネルから回転中心、回転角度、出力データサイズなどを適宜設定。
3. 回転後のデータを保存したい場合、[SAVE to]ボタンから保存。

### 仕様
* 入力waveを変えたい場合は、パネルを消してもう一度Macro > Make_vol_scaleを押してください。
* out rangeで回転によって生まれる余白を何で埋めるか決めます。
* [Optimize range]ボタンを押すと、データの全範囲を設定できます。
* 3D waveの回転は、x-yに対してのみ行われます。
* 3D waveを入力として選択すると、[Extract slice]ボタンが出現し、回転後のx=0におけるスライスを見ながら操作が行えます。

## trim_image
2D waveをデータの品質（スケール、データの粗さ）を完全に保持した状態でトリミングするマクロ

### 使い方
1. トリミングしたい2D waveをデータブラウザで一つ選択し、Macro > Call_Trim_Image_panelを選択。
2. 出現したパネルから切り取り範囲など適宜設定。
3. トリミング後のデータを保存したい場合、[SAVE]ボタンから保存。

### 仕様
* 切り取り範囲は、データポイントまたはデータスケールのどちらからでも設定できます。
* パネル左側のイメージプロットで、切り取り範囲をマウス操作で設定できます。
* [Auto set]ボタンを押すと、outrangeに入れられた値を外側とみなし、自動的に切り取り範囲の設定がなされます。